namespaces:
  - mc
  - ekf

includes:
  - common/defs.h

state_name: State
error_state_name: ErrorState
input_name: Input

state_composition:
  pose: DQuat
  vel: Vec3
  acc_bias: Vec3
  gyro_bias: Vec3
  gps_clk: Vec2
  gal_clk: Vec2
  glo_clk: Vec2
  p_b2g: Vec3
  T_I2e: DQuat
  sd: Vec2

measurements:
  pointPos:
    type: Vec6
    gating_probability: 1.0
    states:
      - pose
      - T_I2e
      - p_b2g
      - vel
  gps_obs:
    type: Vec2
    gating_probability: 1.0
    states:
      - pose
      - T_I2e
      - p_b2g
      - gps_clk
      - vel
    disabled: True
    metadata:
      - [int, sat_id]
    constants:
      - [int, ID, GnssID::GPS]
  gal_obs:
    type: Vec2
    gating_probability: 1.0
    states:
      - pose
      - T_I2e
      - p_b2g
      - gal_clk
      - vel
    disabled: True
    metadata:
      - [int, sat_id]
    constants:
      - [int, ID, GnssID::Galileo]
  glo_obs:
    type: Vec2
    gating_probability: 1.0
    states:
      - pose
      - T_I2e
      - p_b2g
      - glo_clk
      - vel
    disabled: True
    metadata:
      - [int, sat_id]
    constants:
      - [int, ID, GnssID::Glonass]
  fix_and_hold:
    type: Vec2
    gating_probability: 1.0
    states:
      - sd

input:
  accel: Vec3
  gyro: Vec3

dynamics:
  #  pose, vel, angular_vel, acc_bias, gyro_bias, gps_clk, gal_clk, glo_clk, p_b2g, T_I2e, sd,
  pose: [[pose, vel, gyro_bias], [gyro]]
  vel: [[pose, acc_bias], [accel]]
  acc_bias: [[], []]
  gyro_bias: [[], []]
  gps_clk: [[gps_clk], []]
  gal_clk: [[gal_clk], []]
  glo_clk: [[glo_clk], []]
  p_b2g: [[], []]
  T_I2e: [[], []]
  sd: [[], []]
